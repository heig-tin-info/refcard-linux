\documentclass[9pt]{extarticle}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage[a4paper,landscape,margin=10mm]{geometry}
\usepackage{multicol}
\usepackage{fontawesome}
\usepackage[most]{tcolorbox}
\usepackage{fontspec}
\usepackage[french]{babel}
\usepackage{microtype}
\usepackage{enumitem}

\setlength{\columnsep}{5mm}
\setlength{\columnseprule}{0.4pt}

\setlist{nosep,leftmargin=1.1em}
\setlength{\parindent}{0pt}
\setlength{\parskip}{2pt}

% \setmainfont{TeX Gyre Heros}
% \setsansfont{TeX Gyre Heros}
% \setmonofont{Inconsolata}
\renewcommand{\familydefault}{\sfdefault}


\usepackage{listings}
\usepackage{xparse}

% Règles de remplacement (STARRED !) pour listings
\lstset{
  basicstyle=\ttfamily\footnotesize,
  columns=fullflexible,
  keepspaces=true,
  upquote=true,
  breaklines=true,
  literate=*%
    {[f]}{{\raisebox{-0.15ex}{\scriptsize\faFileO}}}3
    {[fc]}{{\raisebox{-0.15ex}{\scriptsize\faFileCodeO}}}4
    {[fa]}{{\raisebox{-0.15ex}{\scriptsize\faFileArchiveO}}}4
    {[d]}{{\raisebox{-0.15ex}{\scriptsize\faFolderO}}}3
    {[p]}{{\raisebox{-0.15ex}{\scriptsize\faFilePowerpointO}}}2
    {[t]}{{\raisebox{-0.15ex}{\scriptsize\faHashtag}}}2
    {uu}{{test}}2
}

\NewDocumentCommand{\code}{v}{%
  \tcbox[
    on line,
    colframe=black!60, colback=black!5,
    bottom=1.5pt, left=1.5pt, right=1.5pt, top=1.5pt,
    boxrule=0.4pt, arc=2pt, boxsep=0.2pt,
    fontupper=\ttfamily\footnotesize,
    before upper=\rule{0pt}{0.7em},
    tcbox raise base
  ]{\lstinline!#1!}%
}

\newtcbox{\inlinecode}{nobeforeafter,
  colframe=black!40, colback=black!5,
  boxrule=0.3pt, arc=2pt,
  boxsep=1pt, % padding global
  left=1.5pt, right=1.5pt, top=1.5pt, bottom=1.5pt, % marges internes
  tcbox raise base,
  fontupper=\ttfamily\footnotesize
}

%\lstMakeShortInline[columns=flexible]{|}

%\newcommand{\lstcode}[1]{\inlinecode{#1}}
% remplace ta définition existante
\newcommand{\lstcode}[1]{\inlinecode{\detokenize{#1}}}
\newcommand{\lstc}[1]{\inlinecode{#1}}

\usepackage[os=win]{menukeys}
\renewmenumacro{\keys}[+]{roundedkeys}

\let\oldkeys\keys
\renewcommand{\keys}[1]{\small\oldkeys{#1}\normalsize}

\renewcommand{\familydefault}{\sfdefault}

\usepackage{titlesec}

% Tailles des titres (s'applique aussi aux versions étoilées *)
\titleformat{\section}
  {\sffamily\bfseries\fontsize{12}{15}\selectfont} % ajoute  si tu veux en gras
  {}{0pt}{}

\titleformat{\subsection}
  {\sffamily\bfseries\fontsize{10}{12}\selectfont}
  {}{0pt}{}

\titleformat{\subsubsection}
  {\sffamily\bfseries\fontsize{8}{10}\selectfont}
  {}{0pt}{}

% Espacements (les tiens, inchangés)
\titlespacing*{\section}{0pt}{0.1ex plus .1ex minus 0.1ex}{0.5ex plus .1ex minus 0.1ex}
\titlespacing*{\subsection}{0pt}{0.1ex plus .1ex minus 0.1ex}{0.5ex plus .1ex minus 0.1ex}
\titlespacing*{\subsubsection}{0pt}{0.1ex plus .1ex minus 0.1ex}{0.5ex plus .1ex minus 0.1ex}


\pagenumbering{gobble}

% \titlespacing*{\section}{0pt}{0.5ex plus .1ex minus 0.1ex}{0.5ex plus .1ex minus 0.1ex}
% \titlespacing*{\subsection}{0pt}{0.5ex plus .1ex minus 0.1ex}{0.5ex plus .1ex minus 0.1ex}
% \titlespacing*{\subsubsection}{0pt}{0.5ex plus .1ex minus 0.1ex}{0.5ex plus .1ex minus 0.1ex}

\newlength\mybaselinestretch
\mybaselinestretch=0pt plus 0.02pt\relax
\addtolength{\baselineskip}{\mybaselinestretch}

\setlength\parindent{0pt}
\setlength\tabcolsep{1.5pt}
\setlength{\columnseprule}{0.4pt}

\input{revision}

% % Largeur de la colonne "commande" + écart
% \newlength{\cmdlabelwidth} \setlength{\cmdlabelwidth}{2.8cm} % ajuste au besoin
% \newlength{\cmdlabelsep}   \setlength{\cmdlabelsep}{0.4em}

% % Bloc de commandes compact
% \newenvironment{cmdblock}{%
%   \par\setlength{\parindent}{0pt}\setlength{\parskip}{0pt}%
% }{\par}

% % Une ligne "commande — description" compacte avec wrap automatique
% \newcommand{\cmditem}[2]{%
%   \noindent
%   \makebox[\cmdlabelwidth][l]{\inlinecode{#1}}%
%   \hspace{\cmdlabelsep}%
%   \parbox[t]{\dimexpr\linewidth-\cmdlabelwidth-\cmdlabelsep\relax}{#2}%
%   \par
% }

% PRÉREQUIS
\usepackage{environ}
\usepackage{ragged2e} % pour \RaggedRight

% style de code inline (ton tcolorbox)
% \usepackage[most]{tcolorbox}
% \newtcbox{\inlinecode}{nobeforeafter,
%   colframe=black!40, colback=black!5,
%   boxrule=0.4pt, arc=2pt,
%   boxsep=1pt, left=3pt, right=3pt, top=2pt, bottom=2pt,
%   tcbox raise base,
%   fontupper=\ttfamily\footnotesize
% }

% écart entre la colonne commande et la description
\newlength{\cmdlabelsep} \setlength{\cmdlabelsep}{0.4em}

% largeur “colonne commande” (calculée à la volée)
\newlength{\cmdlabelwidth}

% Définitions par défaut (pour éviter “undefined”)
% \newcommand{\cmditem}[2]{} % placeholder
% \newcommand{\cmdline}[2]{% rendu final d’une ligne
%   \noindent
%   \makebox[\cmdlabelwidth][l]{\inlinecode{#1}}%
%   \hspace{\cmdlabelsep}%
%   \begin{minipage}[t]{\dimexpr\linewidth-\cmdlabelwidth-\cmdlabelsep\relax}
%     \RaggedRight #2%
%   \end{minipage}\par
% }

% Bloc avec mesure automatique de la largeur max
% \NewEnviron{cmdblock}{%
%   % 1) Passe de mesure (aucune sortie)
%   \setlength{\cmdlabelwidth}{0pt}%
%   \setbox0=\vbox{%
%     \renewcommand{\cmditem}[2]{%
%       \sbox2{\inlinecode{##1}}%
%       \ifdim\wd2>\cmdlabelwidth
%         \global\setlength{\cmdlabelwidth}{\wd2}%
%       \fi
%     }%
%     \BODY
%   }%
%   % 2) Composition réelle
%   \renewcommand{\cmditem}[2]{\cmdline{##1}{##2}}%
%   \BODY
% }
\newenvironment{cmdblock}{%
  \par\setlength{\parindent}{0pt}\setlength{\parskip}{0pt}%
  \RaggedRight%
}{\par}

\newcommand{\cmditem}[2]{%
  \noindent\inlinecode{#1}\quad #2\par
}
% indentation supplémentaire pour les sous-lignes (options)
\newlength{\cmdoptindent}
\setlength{\cmdoptindent}{1em} % ajuste au goût

\newcommand{\cmdopt}[1]{%
  \hspace*{\cmdoptindent}%
  \begin{minipage}[t]{\dimexpr\linewidth-\cmdoptindent\relax}
    \RaggedRight \itshape #1%
  \end{minipage}\par
}

% \usepackage{xparse}
% \usepackage{tikz}
% \usetikzlibrary{shapes.geometric}
% % distance marge droite -> bord gauche de la règle
% \newlength{\mcRuleOffset}
% \setlength{\mcRuleOffset}{\dimexpr\columnsep/2 - \columnseprule/2\relax}

% % petit triangle contour, pointe vers la droite, collé à la règle
% \newcommand{\mcChevbox}[2]{%
%   \hbox to \linewidth{%
%     \hfil
%     \makebox[0pt][l]{\hskip \mcRuleOffset
%       \tikz[baseline]{%
%         \node[
%           isosceles triangle,
%           shape border rotate=-90,
%           draw, fill=none,
%           inner sep=0pt,
%           minimum width=#1,
%           minimum height=#2,
%           anchor=east
%         ] {};
%       }%
%     }%
%   }%
% }

% % \placeChevron[<largeur>=6pt][<hauteur>=8pt]
% \NewDocumentCommand{\placeChevron}{O{6pt} O{8pt}}{%
%   \begingroup
%   \ifhmode
%     \vadjust pre{\mcChevbox{#1}{#2}}%
%   \else
%     \nointerlineskip\smash{\mcChevbox{#1}{#2}}%
%   \fi
%   \endgroup
% }

\newcommand{\codefa}[2][]{%
  \raisebox{-0.15ex}{\faIcon[#1]{#2}}%
}

\clubpenalty=0            % orphelines (début de page)
\widowpenalty=0           % veuves (fin de page)
\displaywidowpenalty=0

\begin{document}

\raggedcolumns                 % colonnes non équilibrées (hauteurs différentes)
\setlength{\premulticols}{0pt} % pas d'espace avant/après l'environnement
\setlength{\postmulticols}{0pt}
\setlength{\multicolsep}{0pt}
\setlength{\topskip}{0pt plus 2pt minus 1pt}

\begin{multicols}{4}
\raggedbottom

\begin{tabularx}{\columnwidth}{lX}
    \raisebox{-2em}{\includegraphics[height=5em]{assets/linux-logo.pdf}} &
    \begin{raggedright}
      {\Large \bf Linux / Unix} \\
      HEIG-VD -- version \revision \ -- \revisiondate \\
    \end{raggedright}
\end{tabularx}
\begin{raggedright}
Carte de référence des commandes et utilitaires Unix-like courants. Les marqueurs suivants sont utilisés : \code{[f]} : nom de fichier,
\code{[d]} : nom de répertoire,
\code{[p]} : commande,
\code{"s"} : chaîne de caractères
\end{raggedright}

  % File:  {\scriptsize\faFileO\par}
  % Folder: {\scriptsize\faFolderO\par}

\section*{Raccourcis clavier Bash}
\subsection*{Mouvements}

\begin{tabularx}{\columnwidth}{lX}
\keys{\ctrl + B} & recule d'un caractère \\
\keys{\ctrl + F} & avance d'un caractère \\
\keys{\ctrl + A} & début de ligne \\
\keys{\ctrl + E} & fin de ligne \\
\keys{\Alt + B} & recule d'un mot \\
\keys{\Alt + F} & avance d'un mot \\
\end{tabularx}

\subsection*{Édition}

\begin{tabularx}{\columnwidth}{lX}
\keys{\ctrl + H} & comme backspace (\keys{\backspace}) \\
\keys{\ctrl + D} & comme delete (\keys{\del}) \\
\keys{\ctrl + U} & coupe du début au curseur \\
\keys{\ctrl + K} & coupe du curseur à la fin \\
\keys{\ctrl + W} & coupe le mot avant le curseur \\
\keys{\ctrl + Y} & colle le dernier texte coupé \\
\keys{\ctrl + T} & swap le char courant avec le précédent \\
\keys{\Alt + D} & supprime le mot après \\
\keys{\Alt + .} & insère le dernier argument \\
\end{tabularx}

\subsection*{Exécution / complétion}

\begin{tabularx}{\columnwidth}{lX}
\multicolumn{2}{l}{\keys{\ctrl + J}, \keys{\ctrl + M} exécuter (\keys{\return})} \\
\keys{\ctrl + I} & complétion (équivalent \keys{\tab}) \\
\keys{\tab}{} & auto-complétion \\
\end{tabularx}

\subsection*{Contrôle / Appels système}

\begin{tabularx}{\columnwidth}{lX}
\keys{\ctrl + C} & interrompre (\emph{sigint}) \\
\keys{\ctrl + Z} & suspendre (\emph{sigstp}) \\
\keys{\ctrl + L} & effacer l'écran \\
\keys{\ctrl + D} & envoyer \emph{EOF} (ferme le shell) \\
\end{tabularx}

\subsection*{Casse / mots}

\begin{tabularx}{\columnwidth}{lX}
\keys{\Alt + U} & majuscules (mot après) \\
\keys{\Alt + L} & minuscules (mot après) \\
\keys{\Alt + C} & capitalise la première lettre \\
\end{tabularx}

\subsection*{Historique / recherche}

\begin{tabularx}{\columnwidth}{lX}
\keys{\ctrl + R} & recherche historique \\
\keys{\ctrl + G} & annuler la recherche \\
\keys{\ctrl + P} & commande précédente \\
\keys{\ctrl + N} & commande suivante \\
\keys{\ctrl + S} & pause (débloquer: \keys{\ctrl + Q}) \\
\keys{\Alt + <} & début de l'historique \\
\keys{\Alt + >} & fin de l'historique \\
\keys{\Alt + P} & préc. dans l'historique\\
\keys{\Alt + N} & suiv. dans l'historique \\
\end{tabularx}

\section*{Sucres syntaxiques}

\begin{tabbing}
  aaaaaaaaaaaa \= a \kill
\code|~| \> identique à \lstc{\$HOME} \\
\code|.| \> répertoire courant \\
\code|..| \> répertoire parent \\
\code|!!| \> dernière commande \\
\code|!n| \> commande \#n de l'historique \\
\lstc{\$?} \> code retour dernière commande \\
\lstc{\$0} \> nom du script \\
\code{!*} \> arguments ancienne command \\
\code{^abc^123} \> substitution dans dernière cmd. \\
\code{`cmd`} \> obsolète, préférer \lstc{\$(cmd)} \\
\lstc{\$(cmd)} \> substitution de commande \\
\lstc{\${var}} \> rendu de variable \\
\code{{a,b,c}} \> expansion par alternatives \\
\code{{1..5}} \> expansions de séquence \\
\lstc{\$(cmd1; cmd2)} \> sous-coquille \\
\lstc{\$(cmd \&)} \> arrière-plan (sous-coquille) \\
\lstc{\$(( expr ))} \> arithmétique \\
\end{tabbing}

\section*{Redirections / pipes}
\begin{tabbing}
  aaaaaaaaa \= a \kill
\code|[p] > [f]| \> stdout \textrightarrow{} fichier (écrase) \\
\code|[p] >> [f]| \> stdout \textrightarrow{} fichier (ajout) \\
\code|[p] 2> [f]| \> stderr \textrightarrow{} fichier (écrase) \\
\code|[p] &> [f]| \> stdout+stderr \textrightarrow{} fichier (écrase) \\
\code|[p] &>> [f]| \> stdout+stderr \textrightarrow{} fichier (ajout) \\
\code|[p] < [f]| \> stdin depuis fichier \\
\code|[p] << EOF| \> heredoc (jusqu'à EOF) \\
\code|[p] <<< "s"| \> here-string (inject sur stdin) \\
\code{[p] | [p]} \> pipe (stdout \textrightarrow{} stdin) \\
\code{[p] |& [p]} \> pipe (stdout+stderr \textrightarrow{} stdin) \\
\end{tabbing}

\section*{Utilisateur}
\begin{cmdblock}
\code|uptime| \quad temps de fonctionnement depuis reboot \\
\code|date| \quad date et heure actuelles \\
\code|cal| \quad calendrier du mois en cours \\
\code|whoami| \quad nom de l'utilisateur courant \\
\end{cmdblock}

\section*{Fichiers / répertoires}

\begin{cmdblock}
  \code|pwd| \quad chemin répertoire courant \\
  \code|ls| \quad liste les fichiers \\
  \cmdopt{\lstcode{-l} détails, \lstcode{-a} fichiers cachés,
          \lstcode{-h} tailles lisibles, \lstcode{-R} récursif,
          \lstcode{-t} trier par date, \lstcode{-r} ordre inverse,
          \lstcode{-Q} guillemets, \lstcode{-i} inode,
          \lstcode{-d} répertoires seulement, \lstcode{-S} trier par taille,
          \lstcode{-1} un par ligne}
  \code|cd [d]| \quad change de répertoire \\
  \code|touch [f]| \quad crée fichier vide ou met à jour date \\
  \code|mkdir [d]| \quad crée un répertoire. \\
  \cmdopt{\lstcode{-v} verbeux,
    \lstcode{-p} parents si besoin,
    \lstcode{-m [perms]} permissions}
  \code|rmdir [d]| \quad supprime un répertoire vide \\
  \code|rm [f]| \quad supprime un fichier. \\
  \cmdopt{\lstcode{-i} interactif,
    \lstcode{-f} force,
    \lstcode{-v} verbeux,
    \lstcode{-r} récursif}

  \code|cp [src] [dst]| \quad copie un fichier/répertoire. \\
  \cmdopt{\lstcode{-a} archive (récursif + attributs),
    \lstcode{-i} interactif,
    \lstcode{-f} force,
    \lstcode{-v} verbeux,
    \lstcode{-r} récursif}
  \code|mv [src] [dst]| \quad déplace/renomme. \\
  \cmdopt{\lstcode{-i} interactif,
    \lstcode{-f} force,
    \lstcode{-n} ne pas écraser,
    \lstcode{-v} verbeux}
\end{cmdblock}

\section*{Exécution de commandes}
\begin{cmdblock}
\code|source [f]| \quad exécute script dans contexte \\
\code|./[p]| \quad exécute programme dans répertoire courant \\
\end{cmdblock}

\section*{Consultation de fichiers}

\begin{cmdblock}
\code|file [f]|\quad type du fichier\par
\code|stat [f]|\quad infos détaillées\par
\code|wc [f]|\quad compte occurences\par
\cmdopt{\lstcode{-l} lignes, \lstcode{-w} mots, \lstcode{-c} caractères}
\code{head [f]}\quad affiche premières lignes\par
\cmdopt{\lstcode{-n N} N premières lignes}
\code|tail [f]| \quad affiche les dernières lignes \\
\cmdopt{\lstcode{-n N} N dernières lignes,
        \lstcode{-f} temps réel}
\code|less [f]| \quad affiche page par page \\
\code|cat [f]| \quad affiche le contenu \\
\code|hexdump -C [f]| \quad affiche en hexadécimal \\
\code|diff [f1] [f2]| \quad comparaison ligne par ligne \\
\end{cmdblock}

\section*{Variables d'environnement}
\begin{cmdblock}
\code|set| \quad liste variables et fonctions \\
\code|env| \quad liste les variables d'env. \\
\code|export VAR=[s]| \quad crée/mod. variable d'env. \\
\code|echo \$VAR| \quad affiche valeur variable \\
\code|\$PATH| \quad chemin des exécutables \\
\code|\$HOME| \quad répertoire personnel \\
\code|\$SHELL| \quad interpréteur de commandes \\
\code|\$USER| \quad nom de l'utilisateur \\
\code|\$PS1| \quad invite de commande \\
\code|\$PWD| \quad répertoire courant \\
\code|\$OLDPWD| \quad répertoire précédent \\
\end{cmdblock}

\section*{Processus / jobs}
\begin{cmdblock}
\code|[p]\&| \quad exécute en arrière-plan \\
\code|jobs| \quad liste les jobs en cours \\
\code|wait [PID]| \quad attend la fin d'un job \\
\code|disown [PID]| \quad détache un job du shell \\
\code|fg [j]| \quad ramène un job au premier plan \\
\code|bg [j]| \quad relance un job en arrière-plan \\
\code|ps aux| \quad liste les processus \\
\code|kill [pid]| \quad termine un processus \\
\code|killall [p]| \quad termine tous les processus nommés \\
\code|top| \quad moniteur de processus \\
\code|htop| \quad top amélioré (si installé) \\

\end{cmdblock}

\section*{Archives / compression}
\begin{cmdblock}
\code|tar -czvf archive.tar.gz [f]| \quad crée archive .tar.gz \\
\code|tar -xzvf archive.tar.gz| \quad extrait archive .tar.gz \\
\code|zip archive.zip [f]| \quad crée archive .zip \\
\code|unzip archive.zip| \quad extrait archive .zip \\
\code|tar -cJvf archive.tar.xz [f]| \quad crée archive .tar.xz \\
\code|tar -xJvf archive.tar.xz| \quad extrait archive .tar.xz \\
\code|7z a archive.7z [f]| \quad crée archive .7z \\
\code|7z x archive.7z| \quad extrait archive .7z \\
\code|bsdtar -xf [f]| \quad extrait \\
\code|bsdtar -cf archive.tar [f]| \quad crée archive .tar \\
\end{cmdblock}

\section*{Permissions / utilisateurs}

\begin{cmdblock}
\code|chmod| \quad modifie les permissions \\
\cmdopt{\lstcode{u} user, \lstcode{g} group, \lstcode{o} others, \lstcode{a} all,
        \lstcode{+} add, \lstcode{-} remove, \lstcode{=} set exactly}
\code|chown| \quad change le propriétaire \\
\code|chgrp| \quad change le groupe \\
\code|umask| \quad masque de création de fichiers \\
\code|sudo [p]| \quad exécute en superutilisateur \\
\code|su [utilisateur]| \quad change d'utilisateur \\
\code|who| \quad qui est connecté \\
\code|w| \quad qui est connecté et que font-ils \\
\code|id| \quad informations sur l'utilisateur courant \\
\code|groups| \quad groupes de l'utilisateur courant \\
\code|passwd| \quad change le mot de passe \\
\code|last| \quad historique des connexions \\
\end{cmdblock}

\textit{bits :} 1 x, 2 w, 4 r

\section*{Raccourcis less / more / man}
\begin{cmdblock}
Espace: page suivante, \keys{b}: page précédente \\
\keys{\return}{}: ligne suivante, \keys{y}: ligne précédente \\
\keys{/}: rechercher, \keys{n}/\keys{N}: suivant/précédent \\
\keys{g}/\keys{G}: début/fin, \keys{q}: quitter \\
\keys{h}: aide, \keys{m}: marque-page \\
\keys{'}: aller au marque-page, \keys{`}: revenir \\
\end{cmdblock}


\section*{Recherche}
\begin{cmdblock}
\code|grep "s" [f]| \quad cherche une chaîne dans un fichier \\
\cmdopt{\lstcode{-P} regex Perl,
        \lstcode{-r} récursif,
        \lstcode{-i} ignore la casse,
        \lstcode{-v} inverse (non),
        \lstcode{-n} numéro de ligne,
        \lstcode{-c} compte les lignes,
        \lstcode{-l} liste les fichiers,
        \lstcode{-w} mot entier,
        \lstcode{-A n} n lignes après,
        \lstcode{-B n} n lignes avant,
        \lstcode{-C n} n lignes contexte,
        \lstcode{-o} seulement correspondance}
\code|rg "s" [f]| \quad comme grep, plus rapide (si installé) \\
\code|find [d] -name "s"| \quad cherche un fichier \\
\cmdopt{\lstcode{-iname} ignore la casse,
        \lstcode{-type f/d} fichier/répertoire,
        \lstcode{-exec cmd \{\} \;} exécute cmd sur chaque fichier}
\code|locate "s"| \quad cherche un fichier (base de données) \\
\code|which [p]| \quad chemin d'une commande \\
\end{cmdblock}

\section*{Remplacement}
\begin{cmdblock}
\code|sed 's/search/new/g' [f]| \quad remplace avec BRE regex \\
\cmdopt{\lstcode{-i} modifie le fichier,
        \lstcode{-n} n'affiche rien par défaut,
        \lstcode{-E} regex étendues,
        \lstcode{-e} script, \lstcode{-r} regex étendues}
\code|perl -pe 's/search/new/g' [f]| \quad remplace avec regex Perl \\
\cmdopt{\lstcode{-i} modifie le fichier,
        \lstcode{-n} n'affiche rien par défaut,
        \lstcode{-e} script, \lstcode{-l} gère les nouvelles lignes}
\code|perl -0777 -pe 's/search/new/gs' [f]| \quad remplace sur tout le fichier \\
\end{cmdblock}

\section*{Utilitaires}
\begin{cmdblock}
\code|uniq [f]| \quad filtre les lignes consécutives identiques \\
\cmdopt{\lstcode{-c} compte, \lstcode{-d} que les doublons,
        \lstcode{-u} que les uniques, \lstcode{-i} ignore la casse}
\code|sort [f]| \quad trie les lignes \\
\cmdopt{\lstcode{-r} inverse, \lstcode{-n} numérique,
        \lstcode{-k n} clé n, \lstcode{-u} unique,
        \lstcode{-t x} séparateur x}
\code|cut -d x -f n [f]| \quad extrait le champ n, séparé par x \\
\code|awk '{print \$n}' [f]| \quad extrait le champ n (espace séparateur) \\
\code|xargs [p]| \quad construit des lignes de commande \\
\cmdopt{\lstcode{-n N} N arguments par commande,
        \lstcode{-I \{\}} remplace \{\} par l'argument}
\code|tr 'set1' 'set2'| \quad remplace set1 par set2 \\
\cmdopt{\lstcode{-d} supprime set1, \lstcode{-s} squeeze}
\code|tee [f]| \quad duplique le flux vers un fichier \\
\cmdopt{\lstcode{-a} ajoute au fichier, \lstcode{-i} ignore les signaux}
\end{cmdblock}

\section*{Aide}
\begin{cmdblock}
\code|help [p]| \quad aide interne bash \\
\code|[p] --help| \quad aide d'une commande \\
\code|man [p]| \quad manuel d'une commande \\
\code|apropos [terme]| \quad cherche dans les manuels \\
\code|whatis [p]| \quad description commande \\
\end{cmdblock}

\emph{Sections du manuel: 1~utilisateur, 2~syscalls, 3~lib, 4~spéciaux, 5~formats, 6~jeux, 7~divers, 8~admin}

\section*{Gestion Réseau}
\begin{cmdblock}
\code|ip a| \quad liste adresses IP \\
\code|ip r| \quad table de routage \\
\code|ping [hôte]| \quad teste la connectivité \\
\code|ss -tuln| \quad sockets réseau \\
\code|dig [hôte]| \quad résolution DNS avancée \\
\end{cmdblock}

\section*{Internet}
\begin{cmdblock}
\code|ssh user@host| \quad connexion SSH \\
\code|scp [src] [dst]| \quad copie sécurisée \\
\code|wget [url]| \quad télécharge un fichier \\
\cmdopt{\lstcode{-O f} fichier de sortie,
        \lstcode{-c} reprendre, \lstcode{-q} silencieux,
        \lstcode{--limit-rate=100k} limite le débit}
\code|curl [url]| \quad transfère une URL \\
\cmdopt{\lstcode{-o f} fichier de sortie,
        \lstcode{-O} nomme comme l'original,
        \lstcode{-L} suivre redirections,
        \lstcode{-I} en-têtes seulement,
        \lstcode{-d data} données POST,
        \lstcode{-H 'Hdr: v'} ajoute un en-tête}
\code|lynx [url]| \quad navigateur web en console \\
\end{cmdblock}

\section*{Git}
\begin{cmdblock}
\code|git init| \quad initialise un dépôt git \\
\code|git status| \quad statut du dépôt \\
%\code|git remote add origin [url]| \quad ajoute une origine \\
\code|git remote -v| \quad liste les origines \\
\code|git fetch| \quad récupère les changements distants \\
\code|git pull| \quad pull + merge \\
\code|git push| \quad pousse les changements locaux \\
\code|git clone [url]| \quad clone un dépôt distant \\
\code|git branch| \quad liste les branches \\
\code|git branch [br]| \quad crée une branche \\
\code|git checkout [br]| \quad change de branche \\
\code|git commit -m "s"| \quad crée un commit \\
\code|git add [f]| \quad ajoute un fichier au commit \\
\code|git log| \quad historique des commits \\
\cmdopt{\lstcode{--oneline} résumé, \lstcode{--graph} graphe,
        \lstcode{--stat} stats, \lstcode{-p} diff}
\end{cmdblock}

\section*{GCC}
\begin{cmdblock}
\code|gcc [f.c]| \quad compile un fichier C \\
\cmdopt{\lstcode{-o f} nom de l'exécutable,
        \lstcode{-Wall} tous les avertissements,
        \lstcode{-Wextra} avertissements supplémentaires,
        \lstcode{-g} infos debug,
        \lstcode{-O0, -O1, -O2, -O3} optimisation,
        \lstcode{-std=c17} standard C,
        \lstcode{-I dir} inclure répertoire dir,
        \lstcode{-L dir} lier répertoire dir,
        \lstcode{-l lib} lier la bibliothèque lib
        \lstcode{-c} compiler seulement (pas linker)}
\end{cmdblock}

\section*{Python}
\begin{cmdblock}
\code|python -mvenv venv| \quad crée environnement virtuel \\
\code|uv venv venv| \quad même chose avec uv \\
\code|source venv/bin/activate| \quad active l'env. virtuel \\
\code|deactivate| \quad désactive l'env. virtuel \\
\code|pip install pkg| \quad installe un paquet dans l'env. virtuel \\
\code|pip list| \quad liste les paquets installés \\
\end{cmdblock}

\section*{Système}

\begin{cmdblock}
\code|shutdown -h now| \quad arrête le système \\
\code|shutdown -r now| \quad redémarre le système \\
\code|systemctl status [service]| \quad statut d'un service \\
\code|systemctl start [service]| \quad démarre un service \\
\code|systemctl stop [service]| \quad arrête un service \\
\code|systemctl restart [service]| \quad redémarre service \\
\code|systemctl enable [service]| \quad active service \\
\code|systemctl disable [service]| \quad désactive service \\
\code|journalctl -xe| \quad logs système \\
\code|timedatectl| \quad date, heure, fuseau horaire \\
\code|hostnamectl| \quad informations sur le système \\
\end{cmdblock}

\section*{Hardware}

\begin{cmdblock}
\code|uname -a| \quad informations système \\
\code|lscpu| \quad infos CPU \\
\code|lsblk| \quad liste les disques et partitions \\
\code|df -h| \quad espace disque \\
\code|du -sh [f/d]| \quad taille d'un fichier/répertoire \\
\code|free -h| \quad mémoire \\
\end{cmdblock}

\section*{APT (Debian/Ubuntu)}
\begin{cmdblock}
\code|apt update| \quad met à jour liste des paquets \\
\code|apt upgrade| \quad met à jour les paquets installés \\
\code|apt install [pkg]| \quad installe un paquet \\
\code|apt remove [pkg]| \quad désinstalle un paquet \\
\code|apt search [terme]| \quad cherche un paquet \\
\code|apt show [pkg]| \quad informations sur un paquet \\
\code|apt autoremove| \quad supprime dépendances inutiles \\
\code|dpkg -L [pkg]| \quad liste fichiers d'un paquet \\
\code|dpkg -S [f]| \quad quel paquet fournit ce fichier \\
\end{cmdblock}

% \section*{À installer (exemples)}
% \textbf{Utilitaires} : \lstinline|sudo apt install util-linux coreutils findutils grep sed awk wget curl unzip zip tar| \\
% \textbf{Manuels FR} : \lstinline|sudo apt install manpages-fr manpages-fr-extra| \\
% \textbf{Dev} : \lstinline|sudo apt install build-essential git curl wget vim htop| \\
% \textbf{Réseau} : \lstinline|sudo apt install net-tools iputils-ping traceroute dnsutils| \\

\section*{Fun}

\begin{cmdblock}
\code|cowsay "s"| \quad phylactere et vache \\
\code|fortune| \quad citation aléatoire  \\
\code|sl| \quad locomotive à vapeur  \\
\code|cmatrix| \quad effet Matrix  \\
\code|toilet "s"| \quad texte ASCII art  \\
\code|lolcat| \quad texte coloré  \\
\end{cmdblock}

\section*{Substituts modernes conseillés}

\begin{tabularx}{\columnwidth}{lX}
lsd & Substitut de ls  \\
batcat& Amélioration de cat  \\
fd & Substitut de find  \\
ripgrep (rg) & Substitut de grep  \\
sd & Substitut de sed  \\
hexyl & Substitut de hexdump  \\
broot & Explorateur de fichiers CLI  \\
fzf & Outil de recherche floue  \\
git-delta & Substitut de git diff \\
\end{tabularx}

\end{multicols}
\end{document}
